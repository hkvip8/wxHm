安装与部署说明（PHP 微信活码系统）

先决条件
- PHP 8+，扩展：pdo_mysql、openssl
- MySQL 5.7+ 或 MariaDB
- Web 服务器（Nginx/Apache）

快速安装（示例）
1. 将 `php_app/public` 目录配置为站点根目录。
2. 在服务器上准备数据库并导入结构：

   ```bash
   mysql -u root -p < php_app/sql/schema.sql
   ```

3. 访问站点（首次访问会触发安装向导），或手动编辑 `php_app/src/config.php` 填写数据库连接：

   - `db.host`, `db.port`, `db.dbname`, `db.user`, `db.pass`
   - `site.base_url` 填写你的域名，例如 `https://pay.6cloud.net`

4. 在后台登录（默认需注册一个管理员账号并手动把 `users.is_admin` 置为 `1`）：
   - 在数据库中执行：
     ```sql
     UPDATE users SET is_admin=1 WHERE username='你的管理员用户名';
     ```

5. 在后台（后台→支付设置）填写支付商户信息（易支付、微信、支付宝）及回调地址。

6. 使用前请完成安全加固：
   - 配置 HTTPS（强制 TLS）
   - 设置合适的文件权限，确保 `php_app/src/config.php` 可写仅在安装时，随后收回写权限
   - 增加 CSRF 与输入校验（生产环境强烈建议）

功能概览
- 支持按月/按年/按次数的套餐购买
- 易支付 / 微信 / 支付宝 示例集成（需按真实商户参数接入）
- 推广联盟：3 级分佣（后台可配置比例），用户中心显示推广链接、佣金、提现申请
- 活码（huoma）支持跳转提示页、点击统计、按次消耗
- 后台支持提现审核、导出 CSV、批量处理

常见操作
- 导出提现记录：后台→提现审核→勾选记录→点击“导出为 CSV”。
- 批量处理提现：勾选记录→选择“批量批准/拒绝”→执行。

打包源码
- 本项目已包含完整源码，直接部署 `php_app/public` 到 Web 根并根据安装步骤配置

支持与扩展
- 如需自动打款（代发），需接入支付宝/银行商户打款 API，本项目提供提现记录导出，适用于手工或第三方代付流程。

联系
- 若需要我为你对接真实支付（需要商户资料），或做更完善的安全与多语言支持，请反馈商户信息或需求细节。
